<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE refentry PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN" "http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd">
<refentry id="vfs_fileid.8">

<refmeta>
	<refentrytitle>vfs_fileid</refentrytitle>
	<manvolnum>8</manvolnum>
	<refmiscinfo class="source">Samba</refmiscinfo>
	<refmiscinfo class="manual">System Administration tools</refmiscinfo>
	<refmiscinfo class="version">4.6</refmiscinfo>
</refmeta>


<refnamediv>
	<refname>vfs_fileid</refname>
	<refpurpose>Generates file_id structs with unique device id values for
	cluster setups</refpurpose>
</refnamediv>

<refsynopsisdiv>
	<cmdsynopsis sepchar=" ">
		<literal>vfs objects = fileid</literal>
	</cmdsynopsis>
</refsynopsisdiv>

<refsect1>
	<title>DESCRIPTION</title>

	<para>This VFS module is part of the
	<citerefentry><refentrytitle>samba</refentrytitle>
	<manvolnum>7</manvolnum></citerefentry>
	suite.</para>

	<para>Samba uses file_id structs to uniquely identify files
	for locking purpose. By default the file_id contains the device
	and inode number returned by the <literal>stat()</literal> system call.
	As the file_id is a unique identifier of a file, it must be the same
	on all nodes in a cluster setup. This module overloads the
	<literal>SMB_VFS_FILE_ID_CREATE()</literal> operation and
	generates the device number based on the configured algorithm
	(see the "fileid:algorithm" option).
	</para>
</refsect1>


<refsect1>
	<title>OPTIONS</title>

	<variablelist>

		<varlistentry>
		<term>fileid:algorithm = ALGORITHM</term>
		<listitem>
		<para>Available algorithms are <literal>fsname</literal>
		and <literal>fsid</literal>. The default value is
		<literal>fsname</literal>.
		</para>
		<para>The <literal>fsname</literal> algorithm generates
		device id by hashing the kernel device name.
		</para>
		<para>The <literal>fsid</literal> algorithm generates
		the device id from the <literal>f_fsid</literal> returned
		from the <literal>statfs()</literal> syscall.
		</para>
		</listitem>
		</varlistentry>

		<varlistentry>
		<term>fileid:mapping = ALGORITHM</term>
		<listitem>
		<para>This option is the legacy version of the
		<literal>fileid:algorithm</literal> option, which was used in earlier
		versions of fileid mapping feature in custom Samba 3.0 versions.
		</para>
		</listitem>
		</varlistentry>

	</variablelist>
</refsect1>

<refsect1>
	<title>EXAMPLES</title>

	<para>Usage of the <literal>fileid</literal> module with the
	<literal>fsid</literal> algorithm:</para>

<programlisting format="linespecific">
        <parameter>[global]</parameter>
	<link xmlns:xlink="http://www.w3.org/1999/xlink" linkend="VFSOBJECTS" xlink:href="smb.conf.5.html#VFSOBJECTS">vfs objects = fileid</link>
	<link xmlns:xlink="http://www.w3.org/1999/xlink" linkend="FILEID:ALGORITHM" xlink:href="smb.conf.5.html#FILEID:ALGORITHM">fileid:algorithm = fsid</link>
</programlisting>

</refsect1>

<refsect1>
	<title>VERSION</title>

	<para>This man page is correct for version 3.2 of the Samba suite.
	</para>
</refsect1>

<refsect1>
	<title>AUTHOR</title>

	<para>The original Samba software and related utilities
	were created by Andrew Tridgell. Samba is now developed
	by the Samba Team as an Open Source project similar
	to the way the Linux kernel is developed.</para>

</refsect1>

</refentry>
